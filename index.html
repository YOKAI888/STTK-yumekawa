<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ğŸŒ¸çœŸãƒ»ã‚¹ãƒ†ãƒ«ã‚¹è¨ˆç®—æ©ŸğŸŒ¸</title>
    <style>
        /* ---- Animations ---- */
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes cloudDrift { from { transform: translate(-10%, 0); } to { transform: translate(10%, 0); } }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-15px) rotate(2deg); } }

        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; background: #fff5f8; }
        body { font-family: "Hiragino Maru Gothic ProN", "Yu Gothic UI", sans-serif; -webkit-user-select: none; }

        /* èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
        #bg-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;
            background: linear-gradient(-45deg, #ffcde8, #d2f4ff, #ffe0ec, #e9d5ff);
            background-size: 400% 400%; animation: gradientBG 15s ease infinite;
        }

        /* è¦–èªæ€§ã®é«˜ã„é›² */
        .cloud {
            position: absolute; border-radius: 50%; z-index: 1;
            background: rgba(255, 255, 255, 0.85);
            filter: blur(45px); animation: cloudDrift 25s infinite alternate ease-in-out;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ«ã‚¨ãƒªã‚¢ï¼ˆæ—§verã®è¼ãã‚’ç¶™æ‰¿ï¼‰ */
        #header-wrapper {
            position: relative; z-index: 100; padding: 15px 0;
            background: rgba(255, 255, 255, 0.5); backdrop-filter: blur(10px);
            border-bottom: 3px dotted #ffb7d1; text-align: center;
        }
        h1 {
            font-size: 1.8rem; margin: 0; color: #ff3399;
            text-shadow: 0 0 15px rgba(255,255,255,1), 2px 2px 0 #fff;
            letter-spacing: 2px;
        }

        /* è¨ˆç®—æ©ŸUIï¼šå³ä¸Šã«é…ç½® */
        #calc-ui {
            position: fixed; top: 90px; right: 20px; z-index: 200;
            background: rgba(255, 255, 255, 0.95); padding: 12px; border-radius: 20px;
            box-shadow: 0 8px 32px rgba(255, 105, 180, 0.3); width: 185px; border: 2px solid #ffcfe5;
        }
        #calc-display {
            width: 100%; height: 35px; background: #fff; border: 1px solid #ffcfe5; margin-bottom: 8px;
            text-align: right; padding: 5px; box-sizing: border-box; font-size: 20px; color: #ff3399; 
            border-radius: 8px; font-weight: bold; outline: none;
        }
        .calc-btn {
            width: 40px; height: 40px; margin: 1px; border: none; background: #fff0f6;
            color: #ff66aa; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s;
        }
        .calc-btn:active { background: #ff66aa; color: white; transform: scale(0.9); }

        /* èŒç³¸ã‚³ãƒ³ãƒ†ãƒŠ */
        #mycelium { position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 10; pointer-events: none; }

        /* ç­‘ç´«ï¼šæ—§verã®è³ªæ„Ÿ ï¼† ãƒ•ã‚¡ãƒ•ã‚¡ãƒ•ã‚¡ãƒƒå‡ºç¾ */
        .mushroom-wrapper {
            position: absolute; width: 100px; height: 140px;
            display: flex; justify-content: center; align-items: center;
            z-index: 15; cursor: pointer; pointer-events: auto;
            transition: transform 2.8s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.8s;
            will-change: transform, opacity;
        }
        .mushroom-inner { animation: float 5s infinite ease-in-out; }

        .mushroom {
            width: 95px; height: 125px;
            background: radial-gradient(ellipse at top,#ffffff 0%,#ffccff 25%,#ff99cc 60%,#ff6699 100%);
            border-radius: 70% 70% 55% 55% / 80% 80% 50% 50%;
            display:flex; align-items:center; justify-content:center;
            font-size:12px; color:#fff; font-weight:800; text-align:center;
            padding: 10px; box-sizing: border-box; position: relative;
            box-shadow: 0 0 35px #ff99cc, inset 0 0 25px #fff, 0 0 60px rgba(255,105,180,0.4);
            text-shadow: 0 0 8px #ff3399;
        }
        .mushroom::before { content: 'ğŸŒ¸'; position: absolute; top: -28px; font-size: 32px; text-shadow: 0 0 15px #ff66cc; }
        .mushroom::after {
            content:''; position:absolute; bottom:-30px; left:50%; transform:translateX(-50%);
            width:20px; height:45px; background:linear-gradient(to bottom,#ff99cc,#ff6699);
            border-radius:10px; box-shadow:0 0 20px #ff66cc;
        }

        .heart { position:absolute; font-size:24px; pointer-events:none; z-index:250; }
    </style>
</head>
<body>
    <div id="bg-container">
        <div class="cloud" style="width:500px; height:250px; top:8%; left:-5%;"></div>
        <div class="cloud" style="width:400px; height:200px; top:65%; left:60%;"></div>
        <div class="cloud" style="width:300px; height:180px; top:35%; left:20%; background: rgba(255,255,255,0.5);"></div>
    </div>
    
    <div id="header-wrapper">
        <h1>ğŸŒ¸ã‚¹ãƒ†ãƒ«ã‚¹å“ä¸Šè¨ˆç®—æ©Ÿã¸ã‚ˆã†ã“ãã€‚ä»»æ„ã®ã¤ãã—ã«è§¦ã‚Œã¦Xã«æŠ•ç¨¿ã—ã‚ˆã†ã€‚ğŸŒ¸</h1>
    </div>

    <div id="calc-ui">
        <input type="text" id="calc-display" readonly value="0">
        <div>
            <button class="calc-btn" onclick="addChar('7')">7</button><button class="calc-btn" onclick="addChar('8')">8</button><button class="calc-btn" onclick="addChar('9')">9</button><button class="calc-btn" onclick="addChar('/')">Ã·</button><br>
            <button class="calc-btn" onclick="addChar('4')">4</button><button class="calc-btn" onclick="addChar('5')">5</button><button class="calc-btn" onclick="addChar('6')">6</button><button class="calc-btn" onclick="addChar('*')">Ã—</button><br>
            <button class="calc-btn" onclick="addChar('1')">1</button><button class="calc-btn" onclick="addChar('2')">2</button><button class="calc-btn" onclick="addChar('3')">3</button><button class="calc-btn" onclick="addChar('-')">-</button><br>
            <button class="calc-btn" onclick="addChar('0')">0</button><button class="calc-btn" onclick="resetCalc()">C</button><button class="calc-btn" onclick="execCalc()">=</button><button class="calc-btn" onclick="addChar('+')">+</button>
        </div>
    </div>

    <div id="mycelium"></div>

    <script>
        const container = document.getElementById('mycelium');
        const display = document.getElementById('calc-display');
        const concepts = ["ã‚«ãƒ³ãƒˆã®ãã‚…ã‚“è„³æ­»å‘½æ³•ğŸ’—","ãƒ‹ãƒ¼ãƒã‚§ã®ãƒ‰ã‚­ãƒ‰ã‚­å›å¸°ğŸ’—","è˜å­ã®ã‚†ã‚ã‚†ã‚å¤¢ğŸ’—","ãƒ©ãƒ—ãƒ©ã‚¹ã®è„³æ­»æ‚ªé­”ğŸ’—","ã‚²ãƒ¼ãƒ‡ãƒ«ã®ãµã‚ãµã‚å®šç†ğŸ’—","ãƒ”ã‚¿ã‚´ãƒ©ã‚¹ã®ãƒãƒ¼ãƒˆå®šç†ğŸ’—","ã‚ªã‚¤ãƒ©ãƒ¼ã®ãƒ©ãƒ–å…¬å¼ğŸ’•","ã‚·ãƒ¥ãƒ¬ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼ã®ãã‚…ã‚“ğŸ’•","è„³æ­»ã®ãã‚…ã‚“çš„å¸°ç´æ³•ğŸ’•","ãƒ”ã‚¿ã‚´ãƒ©ã‚¹ã®è„³æ­»å®šç†ğŸ’•","è„³å‘³å™ŒãŠèŠ±ç•‘ã®è¨¼æ˜ğŸ’•","è„³ãã‚…ã‚“çˆ†ç™ºğŸ’—","ãµã‚ãµã‚è„³æ­»é©å‘½ğŸ’•","ãƒ©ãƒ–ãƒªãƒ¼ãƒ»ãƒ©ã‚¸ã‚¢ãƒ³ãƒ»ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚¯ã‚¹ğŸ’•"];

        // ---- è¨ˆç®—æ©Ÿãƒ­ã‚¸ãƒƒã‚¯ ----
        window.addChar = (char) => {
            if(display.value === "0" || display.value === "IQ200") display.value = char;
            else display.value += char;
        };
        window.resetCalc = () => { display.value = "0"; };
        window.execCalc = () => {
            if(display.value === '111') {
                for(let i=0; i<30; i++) setTimeout(() => growMushroom(true), i * 65);
            }
            display.value = "IQ200";
        };

        // ---- æ„›ã®èƒå­ï¼ˆãƒãƒ¼ãƒˆï¼‰ç”Ÿæˆ ----
        function createHeart(x, y, emoji = 'ğŸ’—') {
            const h = document.createElement('div');
            h.className = 'heart'; h.innerText = emoji;
            h.style.left = x + 'px'; h.style.top = y + 'px';
            document.body.appendChild(h);
            h.animate([
                { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                { transform: `translate(${(Math.random()-0.5)*450}px, -450px) scale(0)`, opacity: 0 }
            ], { duration: 2500, easing: 'ease-out' }).onfinish = () => h.remove();
        }

        // ---- ç­‘ç´«ï¼ˆãã®ã“ï¼‰ç”Ÿæˆ ----
        function growMushroom(isBurst = false) {
            const wrapper = document.createElement('div');
            wrapper.className = 'mushroom-wrapper';
            const x = (Math.random() * 88 + 6);
            const y = (Math.random() * 65 + 15);
            
            wrapper.style.left = x + '%';
            wrapper.style.bottom = '-180px';
            wrapper.style.opacity = '0';

            const inner = document.createElement('div');
            inner.className = 'mushroom-inner';
            const mush = document.createElement('div');
            mush.className = 'mushroom';
            const concept = concepts[Math.floor(Math.random() * concepts.length)];
            mush.innerText = concept;

            inner.appendChild(mush);
            wrapper.appendChild(inner);
            container.appendChild(wrapper);

            // ã€Œãƒ•ã‚¡ãƒ•ã‚¡ãƒ•ã‚¡ãƒƒã€ã¨ä¸‹ã‹ã‚‰ã›ã‚Šä¸ŠãŒã‚‹
            requestAnimationFrame(() => {
                wrapper.style.transform = `translateY(-${y + 20}vh)`;
                wrapper.style.opacity = '1';
            });

            // ğŸŒ¸ ã‚¹ãƒãƒ›ãƒ»PCå…±é€šï¼šè§¦ã‚ŒãŸç¬é–“ã®ãã‚…ã‚“ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
            const handleTouch = (e) => {
                const pos = e.touches ? e.touches[0] : e;
                for(let i=0; i<11; i++) createHeart(pos.clientX, pos.clientY, 'ğŸ’•');
            };
            wrapper.addEventListener('touchstart', handleTouch, {passive: true});
            wrapper.addEventListener('mouseenter', handleTouch);

            // ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—ç¢ºå®šï¼šXæŠ•ç¨¿
            wrapper.onclick = (e) => {
                for(let i=0; i<15; i++) createHeart(e.clientX, e.clientY, 'ğŸ’—');
                window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent('ğŸ’•'+concept+' #è„³æ­»ã”ã¿ã°ã“')}`, '_blank');
                wrapper.style.transform += ' scale(0) rotate(540deg)';
                setTimeout(() => wrapper.remove(), 800);
            };

            // è‡ªç„¶æ¶ˆæ»…
            setTimeout(() => {
                if(wrapper.parentNode) {
                    wrapper.style.opacity = '0';
                    wrapper.style.transform += ' translateY(-150px)';
                    setTimeout(() => wrapper.remove(), 2500);
                }
            }, isBurst ? 12000 : 18000);
        }

        // å®šæœŸçš„ã«ç”Ÿã‚„ã™
        setInterval(() => {
            if(document.querySelectorAll('.mushroom-wrapper').length < 12) growMushroom();
        }, 3000);

        growMushroom();
    </script>
</body>
</html>